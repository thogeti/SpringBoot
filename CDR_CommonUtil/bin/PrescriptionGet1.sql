SELECT DISTINCT
                /*+FIRST_ROWS*/ 
                rx.rxid                  RX_RXID, 
                rx.storenum              STORENUM, 
                rx.updttimestamp         RX_UPDTTIMESTAMP, 
                rx.adminstartdate        RX_ADMINSTARTDATE, 
                rx.adminstopdate         RX_ADMINSTOPDATE, 
                rx.isathrtv              RX_ISATHRTV, 
                rx.cnsmrid               RX_CNSMRID, 
                rx.prdcrid               RX_PRDCRID, 
                rx.qtytxd                RX_QTYTXD, 
                rx.rmngqty               RX_RMNGQTY, 
                rx.rxnum                 RX_RXNUM, 
                rx.rflsrmngcnt           RX_RFLSRMNGCNT, 
                rx.totalqtyathrzd        RX_TOTALQTYATHRZD, 
                rx.drgtotaldaysofsplycnt RX_DRGTOTALDAYSOFSPLYCNT, 
                rx.drgtrldaysofsplycnt   RX_DRGTRLDAYSOFSPLYCNT, 
                rx.drgtrlflg             RX_DRGTRLFLG, 
                rx.drgtrlqty             RX_DRGTRLQTY, 
                rx.infrdrxflg            RX_INFRDRXFLG, 
                rx.numofrfls             RX_NUMOFRFLS, 
                rx.rxdt                  RX_RXDT, 
                rx.rxexprtndt            RX_RXEXPRTNDT, 
                rx.sigaddtnlinfrmation   RX_SIGADDTNLINFRMATION, 
                rx.sigdescrptntlang      RX_SIGDESCRPTNTLANG, 
                rx.rxdspnsblflg          RX_RXDSPNSBLFLG, 
                rx.legacyflg             RX_LEGACYFLG, 
                rx.hldenddt              RX_HLDENDDT, 
                rx.crttimestamp          RX_CRTTIMESTAMP, 
                rx.qtyrxd                RX_QTYRXD, 
                rx.svclockey             RX_SVCLOCKEY, 
                rx.prscbrkey             RX_PRSCBRKEY, 
                rx.linkedrxkey           RX_LINKEDRXKEY, 
                rx.rcrdrkey              RX_RCRDRKEY, 
                rx.sprvsrkey             RX_SPRVSRKEY, 
                rx.storenum              RX_STORENUM, 
                rx.batchflg              RX_BATCHFLG, 
                rx.rxkey                 RX_RXKEY, 
                rx.rnwlrsntypkey         RX_RNWLRSNTYPKEY, 
                rx.txsubdclndrsntypkey   RX_TXSUBDCLNDRSNTYPKEY, 
                rx.nosubrsntypkey        RX_NOSUBRSNTYPKEY, 
                rx.prscbrtypkey          RX_PRSCBRTYPKEY, 
                rx.rxhldrsntypkey        RX_RXHLDRSNTYPKEY, 
                rx.rxrfslrsntypkey       RX_RXRFSLRSNTYPKEY, 
                rx.rxrsmrsntypkey        RX_RXRSMRSNTYPKEY, 
                rx.rxsrcetypkey          RX_RXSRCETYPKEY, 
                rx.sigcd                 RX_SIGCD, 
                rx.strngthuomtypkey      RX_STRNGTHUOMTYPKEY, 
                rx.subinitrtypkey        RX_SUBINITRTYPKEY, 
                rx.trtmnttypkey          RX_TRTMNTTYPKEY, 
                rx.cmpndkey              RX_CMPNDKEY, 
                rx.drgkey                RX_DRGKEY, 
                rx.packkey               RX_PACKKEY, 
                rx.ptntkey               RX_PTNTKEY, 
                rx.prsnkey               RX_PRSNKEY, 
                rx.prescriberaddrkey     RX_PRESCRIBERADDRKEY, 

                s.FILLSTATEFFDT          RXSTAT_FILLSTATEFFDT,
                s.FILLSTATKEY            RXSTAT_FILLSTATKEY,
                s.SUBFILLSTATKEY         RXSTAT_SUBFILLSTATKEY,

                prsnrl.ISACTFLG          PRSNRL_ISACTFLG,
                prsnrl.PRSNRLTYPKEY      PRSNRL_PRSNRLTYPKEY,
                prsnrl.PROVKEY           PRSNRL_PROVKEY,
                prsn.CNSMRID             PRSN_CNSMRID,
                prsn.FRSTNM              PRSN_FRSTNM, 
                prsn.LSTNM               PRSN_LSTNM,
                prsn.MDLNM               PRSN_MDLNM, 
                prsn.PRDCRID	         PRSN_PRDCRID,
                prsn.PRSNKEY,

                a.MAILFLG                isMailAddressFlag,
                a.REAUTHEMAILFLAG        isReauthEmailFlag,
                a.REAUTHPHONEFLAG        isReauthPhoneFlag,
                a.REAUTHFAXFLAG          isReauthFaxFlag,
                a.REAUTHVISITFLAG        isReauthVisitFlag,

                pack.packid              PACK_PACKID, 
                pack.altrntvpacksz       PACK_ALTRNTVPACKSZ, 
                pack.altrntvpackszuom    PACK_ALTRNTVPACKSZUOM, 
                pack.strngth             PACK_STRNGTH, 
                pack.gtin                PACK_GTIN, 
                pack.isactflg            PACK_ISACTFLG, 
                pack.cnsmrid             PACK_CNSMRID, 
                pack.iscrntflg           PACK_ISCRNTFLG, 
                pack.prdcrid             PACK_PRDCRID, 
                pack.mfctrdiscntddt      PACK_MFCTRDISCNTDDT, 
                pack.packsz              PACK_PACKSZ, 
                pack.mstrid              PACK_MSTRID, 
                pack.packkey             PACK_PACKKEY, 
                pack.packszuomtypkey     PACK_PACKSZUOMTYPKEY, 
                pack.strngthuomtypkey    PACK_STRNGTHUOMTYPKEY, 
                pack.drgkey              PACK_DRGKEY 

  FROM RXSTAT s,
       RX,
       prsnrl, prsn,
       PACK,
       PRESCRIBER_ADDRESS_FLAG a

 where RX.RXKEY = s.RXKEY
 and RX.RXKEY in (?, ?, ?)
   and RX.PTNTKEY = ? and to_char(rx.updttimestamp, 'YYYY-MM-DD') >= ?
   and rx.prscbrkey = prsnrl.PRSNRLKEY(+) and prsnrl.prsnkey = prsn.prsnkey
   and RX.PACKKEY = PACK.PACKKEY(+)
   and rx.prescriberaddrkey = a.prescriberaddrkey(+)